"use strict";var e=require("../../common/vendor.js"),o=require("../../common/js/mylogin.js"),a=require("../../common/js/request.js");require("../../common/js/tools.js");const t={data:()=>({userInfo:e.index.getStorageSync("user_info"),indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,noticetext:"",incomecount:0,paycount:0,accountFormData:{money:0,reType:1,keepTime:"",remark:"",planId:"",payType:"",purpose:""},reTypes:[{text:"收入",value:0},{text:"支出",value:1}],planIdRange:[],purposeRange:[],payTypeRange:[],rules:{keepTime:{rules:[{required:!0,errorMessage:"请选择日期"}]},purpose:{rules:[{required:!0,errorMessage:"请选择账单分类"}]},payType:{rules:[{required:!0,errorMessage:"请选择支付方式"}]},money:{rules:[{format:"number",errorMessage:"金额只能输入数字"}]},remark:{rules:[{required:!0,errorMessage:"备注不能为空"}]}}}),onLoad(){this.noticetext="欢迎来到亲密记",this.getBillCount(!1)},onReady(){this.getPurpose(),this.getPayType()},methods:{selectCount(){e.index.navigateTo({url:"/pages/index/monthbill/monthbill"})},getPurpose(){const o=e.index.getStorageSync("purpose_data");null!==o&&""!==o||(a.request.getPurpose(),o=e.index.getStorageSync("purpose_data")),this.purposeRange=o},getPayType(){const o=e.index.getStorageSync("paytype_data");null!==o&&""!==o||(a.request.getPayType(),o=e.index.getStorageSync("paytype_data")),this.payTypeRange=o},addBill(){o.mylogin.checkLogin(!1)?this.$refs.popup.open():e.index.showToast({title:"请先登录",icon:"exception",duration:2e3})},submitAccount(o){var a=this;a.$refs[o].validate().then((o=>{console.log(a.accountFormData),e.index.request({url:"/api/ika/v1/accountrecord/add",method:"POST",timeout:3e3,header:{Authorization:a.userInfo.token},data:a.accountFormData,success:o=>{1===o.data.status?(e.index.showToast({title:o.data.message,icon:"success",duration:1e3}),a.$refs.popup.close(),a.getBillCount(!0)):e.index.showToast({title:o.data.message,icon:"error",duration:2e3})},fail:o=>{e.index.showToast({title:o.errMsg,icon:"fail",duration:2e3})}})})).catch((o=>{e.index.showToast({title:o[0].errorMessage,icon:"fail",duration:2e3})}))},changeDate(e){this.accountFormData.keepTime=e},getPlanData(){var o=this;e.index.request({url:"/api/ika/v1/plan/getnotfinish",method:"GET",timeout:3e3,header:{Authorization:o.userInfo.token},success:a=>{1===a.data.status?o.planIdRange=a.data.data:e.index.showToast({title:a.data.message,icon:"error",duration:2e3})},fail:o=>{e.index.showToast({title:o.errMsg,icon:"fail",duration:2e3})}})},changePlanId(e){this.accountFormData.planId=e},getBillCount(t){if(!o.mylogin.checkLogin(!1))return;a.request.getMonthBillCount(t);const n=e.index.getStorageSync("month_income_cache"),r=e.index.getStorageSync("month_paymoney_cache");this.incomecount=n,this.paycount=r}}};if(!Array){(e.resolveComponent("uni-notice-bar")+e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-data-checkbox")+e.resolveComponent("uni-datetime-picker")+e.resolveComponent("uni-data-select")+e.resolveComponent("uni-forms")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../uni_modules/uni-notice-bar/components/uni-notice-bar/uni-notice-bar.js")+(()=>"../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox.js")+(()=>"../../uni_modules/uni-datetime-picker/components/uni-datetime-picker/uni-datetime-picker.js")+(()=>"../../uni_modules/uni-data-select/components/uni-data-select/uni-data-select.js")+(()=>"../../uni_modules/uni-forms/components/uni-forms/uni-forms.js")+(()=>"../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();var n=e._export_sfc(t,[["render",function(o,a,t,n,r,i){return e.e({a:r.noticetext},r.noticetext?{b:e.p({scrollable:!0,single:!0,text:r.noticetext})}:{},{c:r.indicatorDots,d:r.autoplay,e:r.interval,f:r.duration,g:e.t(r.incomecount),h:e.t(r.paycount),i:e.o(((...e)=>i.selectCount&&i.selectCount(...e))),j:e.o(((...e)=>i.addBill&&i.addBill(...e))),k:e.o((e=>r.accountFormData.money=e)),l:e.p({placeholder:"请输入金额",modelValue:r.accountFormData.money}),m:e.p({label:"金额",required:!0,name:"money"}),n:e.o((e=>r.accountFormData.reType=e)),o:e.p({mode:"button",localdata:r.reTypes,modelValue:r.accountFormData.reType}),p:e.p({label:"收支",required:!0}),q:e.o(i.changeDate),r:e.o((e=>r.accountFormData.keepTime=e)),s:e.p({type:"date","clear-icon":!1,modelValue:r.accountFormData.keepTime}),t:e.p({label:"日期",required:!0,name:"keepTime"}),v:e.o((e=>r.accountFormData.purpose=e)),w:e.p({localdata:r.purposeRange,modelValue:r.accountFormData.purpose}),x:e.p({label:"账单分类",required:!0,name:"purpose"}),y:e.o((e=>r.accountFormData.payType=e)),z:e.p({localdata:r.payTypeRange,modelValue:r.accountFormData.payType}),A:e.p({label:"支付方式",required:!0,name:"payType"}),B:e.o(i.getPlanData),C:e.o(i.changePlanId),D:e.o((e=>r.accountFormData.planId=e)),E:e.p({localdata:r.planIdRange,modelValue:r.accountFormData.planId}),F:e.p({label:"计划",name:"planId"}),G:e.o((e=>r.accountFormData.remark=e)),H:e.p({type:"textarea",placeholder:"请输入备注",modelValue:r.accountFormData.remark}),I:e.p({label:"备注",required:!0,name:"remark"}),J:e.sr("valiForm","30ee232c-2,30ee232c-1"),K:e.p({rules:r.rules,modelValue:r.accountFormData}),L:e.o((e=>i.submitAccount("valiForm"))),M:e.sr("popup","30ee232c-1"),N:e.p({type:"left","background-color":"#fff"})})}]]);qa.createPage(n);
