"use strict";var e=require("../../../common/vendor.js");const i={data:()=>({value:"请填写",sex:[{id:0,name:"男"},{id:1,name:"女"},{id:2,name:"不明"}],index:0,date:"请填写",avater:"",description:"",url:"",nickName:"",mobile:"",headimg:"",email:""}),onLoad(){this.getUserInfo01()},methods:{getUserInfo01(){var i=this,a=e.index.getStorageSync("user_info");e.index.showLoading({title:"获取中……"}),e.index.request({url:"/api/ika/v1/user/findbyid",method:"GET",timeout:3e3,header:{Authorization:a.token},success:a=>{e.index.hideLoading(),1===a.data.status?(console.log(a.data.data),i.nickName=a.data.data.uName,i.mobile=a.data.data.phone,i.email=a.data.data.email,i.date=a.data.data.birthday.substring(0,10),i.index=a.data.data.gender,i.description=a.data.data.introduction):e.index.showToast({title:"请求用户信息："+a.data.message,icon:"error",duration:2e3})},fail:i=>{e.index.hideLoading(),e.index.showToast({title:"请求用户信息："+i.errMsg,icon:"fail",duration:2e3})}})},bindPickerChange(e){this.index=e.detail.value},bindRegionChange(e){this.region=e.detail.value},bindDateChange(e){this.date=e.detail.value},bindnickName(e){this.nickName=e.detail.value},bindmobile(e){this.mobile=e.detail.value},binddescription(e){this.description=e.detail.value},bindEmail(e){this.email=e.detail.value},avatarChoose(){let i=this;e.index.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success(e){i.imgUpload(e.tempFilePaths),e.tempFilePaths}})},getUserInfo(){e.index.getUserProfile({desc:"用于完善会员资料",success:i=>{console.log(i),e.index.showToast({title:"已授权",icon:"none",duration:2e3})}})},getphonenumber(i){i.detail.iv&&(console.log(i.detail.iv),e.index.showToast({title:"已授权",icon:"none",duration:2e3}))},savaInfo(){const i=e.index.getStorageSync("user_info");let a=this,t=a.nickName,n=a.index,o=a.mobile,d=a.email,s=a.date,r=a.description,l={id:i.id,weixinId:i.weixinId};t?(l.uName=t,l.gender=n,l.email=d,a.isPoneAvailable(o)?(l.phone=o,"0000-00-00"!=s?(l.birthday=s,l.introduction=r,a.updata(l)):e.index.showToast({title:"请选择生日",icon:"none",duration:2e3})):e.index.showToast({title:"手机号码有误，请重填",icon:"none",duration:2e3})):e.index.showToast({title:"请填写昵称",icon:"none",duration:2e3})},isPoneAvailable:e=>!!/^[1][3,4,5,7,8][0-9]{9}$/.test(e),async updata(i){var a=e.index.getStorageSync("user_info");e.index.showLoading({title:"修改中……"}),e.index.request({url:"/api/ika/v1/user/modify",method:"POST",timeout:3e3,header:{Authorization:a.token},data:i,success:i=>{e.index.hideLoading(),1===i.data.status?e.index.showToast({title:"修改成功",icon:"success",duration:2e3}):e.index.showToast({title:"修改用户信息："+i.data.message,icon:"error",duration:2e3})},fail:i=>{e.index.hideLoading(),e.index.showToast({title:"修改用户信息："+i.errMsg,icon:"fail",duration:2e3})}})},imgUpload(i){let a=this;e.index.uploadFile({header:{Authorization:e.index.getStorageSync("token")},url:"/api/upload/image",filePath:i[0],name:"file",formData:{type:"user_headimg"},success:function(e){var i=JSON.parse(e.data);i=i.data,a.avater=a.url+i.img,a.headimg=a.url+i.img},fail:function(e){console.log(e)}})}}};var a=e._export_sfc(i,[["render",function(i,a,t,n,o,d){return{a:o.value,b:o.nickName,c:e.o(((...e)=>d.bindnickName&&d.bindnickName(...e))),d:o.value,e:o.mobile,f:e.o(((...e)=>d.bindmobile&&d.bindmobile(...e))),g:o.value,h:o.email,i:e.o(((...e)=>d.bindEmail&&d.bindEmail(...e))),j:e.t(o.sex[o.index].name),k:e.o(((...e)=>d.bindPickerChange&&d.bindPickerChange(...e))),l:o.index,m:o.sex,n:e.t(o.date),o:o.date,p:e.o(((...e)=>d.bindDateChange&&d.bindDateChange(...e))),q:o.value,r:o.description,s:e.o(((...e)=>d.binddescription&&d.binddescription(...e))),t:e.o(((...e)=>d.savaInfo&&d.savaInfo(...e)))}}]]);qa.createPage(a);
