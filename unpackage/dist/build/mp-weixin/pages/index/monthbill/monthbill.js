"use strict";var t=require("../../../common/vendor.js"),e=require("../../../common/js/tools.js");const a={components:{fuiEmpty:()=>"../../../components/firstui/fui-empty/fui-empty.js"},data:()=>({userInfo:t.index.getStorageSync("user_info"),isDataEmpty:!0,monthincomecount:0,monthpaycount:0,dayincomecount:0,daypaycount:0,billDatas:[],queryBill:{pageIndex:1,pageSize:100,year:(new Date).getFullYear(),month:(new Date).getMonth()+1,reType:2,startTime:e.tools.formatDate(new Date),endTime:e.tools.formatDate(new Date),remark:""}}),onLoad(){var t=this;t.monthCount("",!0);let a=e.tools.formatDate(new Date);t.dayBillCount(a),t.queryBill.startTime=a,t.queryBill.endTime=a,t.getBillData()},methods:{changeDate(t){var e=this;console.log(t),e.dayBillCount(t.fulldate),e.queryBill.startTime=t.fulldate,e.queryBill.endTime=t.fulldate,e.queryBill.month=t.month,e.queryBill.year=t.year,e.getBillData()},monthCount(e,a){var i=this;if(a){const e=t.index.getStorageSync("month_income_cache"),a=t.index.getStorageSync("month_paymoney_cache");i.monthincomecount=e,i.monthpaycount=a}else t.index.request({url:"/api/ika/v1/accountrecord/statistics",method:"POST",timeout:3e3,header:{Authorization:i.userInfo.token},data:{keepTime:e,timeQueryType:1},success:e=>{1===e.data.status?(i.monthincomecount=e.data.data.statisticsItem[0].incomeMoney,i.monthpaycount=e.data.data.statisticsItem[0].payMoney):t.index.showToast({title:e.data.message,icon:"error",duration:2e3})},fail:e=>{t.index.showToast({title:e.errMsg,icon:"fail",duration:2e3})}})},changeMonth(t){var a=[t.year,t.month,1].map(e.tools.formatNumber).join("-");this.monthCount(a,!1)},dayBillCount(e){var a=this;t.index.request({url:"/api/ika/v1/accountrecord/statistics",method:"POST",timeout:3e3,header:{Authorization:a.userInfo.token},data:{keepTime:e,timeQueryType:0},success:e=>{1===e.data.status?(a.dayincomecount=e.data.data.statisticsItem[0].incomeMoney,a.daypaycount=e.data.data.statisticsItem[0].payMoney):t.index.showToast({title:e.data.message,icon:"error",duration:2e3})},fail:e=>{t.index.showToast({title:e.errMsg,icon:"fail",duration:2e3})}})},getBillData(){var e=this;e.queryBill.pageIndex=1,t.index.showLoading({title:"数据获取中……"}),t.index.request({url:"/api/ika/v1/accountrecord/findbypage",method:"POST",timeout:4e3,header:{Authorization:e.userInfo.token},data:e.queryBill,success:a=>{t.index.hideLoading(),1===a.data.status?(e.billDatas=[],e.isDataEmpty=!1,e.billDatas=a.data.data.accounts):(t.index.showToast({title:a.data.message,icon:"error",duration:2e3}),e.billDatas=[],e.isDataEmpty=!0)},fail:a=>{t.index.hideLoading(),t.index.showToast({title:a.errMsg,icon:"fail",duration:2e3}),e.billDatas=[],e.isDataEmpty=!0}})}}};if(!Array){(t.resolveComponent("uni-calendar")+t.resolveComponent("uni-grid-item")+t.resolveComponent("uni-grid")+t.resolveComponent("fui-empty"))()}Math||((()=>"../../../uni_modules/uni-calendar/components/uni-calendar/uni-calendar.js")+(()=>"../../../uni_modules/uni-grid/components/uni-grid-item/uni-grid-item.js")+(()=>"../../../uni_modules/uni-grid/components/uni-grid/uni-grid.js"))();var i=t._export_sfc(a,[["render",function(e,a,i,o,n,s){return t.e({a:t.o(s.changeDate),b:t.o(s.changeMonth),c:t.p({insert:!0,lunar:!0,"start-date":"1980-1-1","end-date":"2050-5-20"}),d:t.t(n.monthincomecount),e:t.p({index:1}),f:t.t(n.monthpaycount),g:t.p({index:2}),h:t.t(n.dayincomecount),i:t.t(n.daypaycount),j:t.p({column:4,"show-border":!1,highlight:!0,square:!1}),k:n.isDataEmpty},n.isDataEmpty?{l:t.p({src:"../../../static/images/image/img_data_3x.png",title:"暂无数据",descr:"请在首页先添加账单！"})}:{m:t.f(n.billDatas,((e,a,i)=>({a:t.t(e.remark),b:t.t(e.purpose_Desc),c:t.t(e.keepTime.substring(0,10)),d:t.t(1===e.reType?"-":""),e:t.t(e.money),f:t.n(0===e.reType?"billprice":"billprice1")})))})}]]);wx.createPage(i);
