"use strict";var e=require("../../../../common/vendor.js");const t={components:{LEchart:()=>"../../../../components/lime-echart/components/l-echart/l-echart.js"},data:()=>({userInfo:e.index.getStorageSync("user_info"),planId:"",options:{},planText:"",useRate:0,planTime:"\n",planType:"\n",planitem:{}}),onLoad:function(e){this.planId=e.id,this.getPlanMoney(e.id),this.options={series:[{type:"gauge",startAngle:90,endAngle:-270,pointer:{show:!1},progress:{show:!0,overlap:!1,roundCap:!0,clip:!1,itemStyle:{}},axisLine:{lineStyle:{width:40}},splitLine:{show:!1,distance:0,length:10},axisTick:{show:!1},axisLabel:{show:!1,distance:50},data:[{value:20,detail:{offsetCenter:["0%","0%"]}}],detail:{fontSize:24,formatter:"{value}%"}}]}},onReady(e){setInterval((()=>{""!==this.planId&&(console.log(this.planId),this.getPlanMoney(this.planId),this.init())}),3e4)},methods:{getPlanMoney(t){var a=this;e.index.showLoading({title:"获取计划详情中……"}),e.index.request({url:"/api/ika/v1/plan/getbyid?id="+t,method:"GET",timeout:3e3,header:{Authorization:a.userInfo.token},success:t=>{e.index.hideLoading(),1===t.data.status?(a.useRate=t.data.data.recordMoney/t.data.data.amountMoney,a.planText="计划金额："+t.data.data.amountMoney+"元，已完成金额："+t.data.data.recordMoney+"元",a.planitem=t.data.data,a.planTime=t.data.data.startTime.substring(0,10)+"~"+t.data.data.endTime.substring(0,10)+"\n",a.planType=t.data.data.planType_Desc+"\n"):e.index.showToast({title:"请求计划详情："+t.data.message,icon:"error",duration:2e3})},fail:t=>{e.index.hideLoading(),e.index.showToast({title:"请求计划详情："+t.errMsg,icon:"fail",duration:2e3})}})},init(){var t=this;t.$refs.chart.init(e.echarts,(e=>{t.options.series[0].pointer.show=!1,t.options.series[0].data[0].value=(100*t.useRate).toFixed(2)-0,e.setOption(t.options,!0)}))}}};if(!Array){(e.resolveComponent("uni-section")+e.resolveComponent("l-echart")+e.resolveComponent("uni-card"))()}Math||((()=>"../../../../uni_modules/uni-section/components/uni-section/uni-section.js")+(()=>"../../../../uni_modules/uni-card/components/uni-card/uni-card.js"))();var a=e._export_sfc(t,[["render",function(t,a,n,i,o,s){return e.e({a:o.useRate>0},o.useRate>0?{b:e.p({title:"计划进度","sub-title":o.planText,type:"line"}),c:e.sr("chart","7aaf0d76-1"),d:e.o(s.init)}:{},{e:e.p({title:"计划内容",type:"line"}),f:e.t(o.planTime),g:e.t(o.planType),h:e.t(o.planitem.remark),i:e.p({title:o.planitem.name,"sub-title":o.planitem.code,extra:(0===o.planitem.reType?"+":"-")+o.planitem.amountMoney})})}]]);wx.createPage(a);
