import{c as e,r as a,o as t,a as o,w as l,b as n,d as i,n as s,e as r,f as c,t as u,i as d,g as m,h as p,j as h,s as f,k as y,l as g,m as b,p as _,q as A,F as x,u as k,v as w,S as D,x as C,y as F}from"./index.4e9e22c6.js";import{_ as T}from"./uni-icons.f3e1d0b6.js";import{_ as V,r as I}from"./uni-app.es.4dca259d.js";import{_ as M}from"./uni-easyinput.ecec7ebb.js";import{_ as P,a as S,b as v,c as z,d as R}from"./uni-forms.8391990d.js";import{_ as B}from"./uni-popup.e977e3bd.js";import{m as E}from"./mylogin.14a446ff.js";import{t as j}from"./tools.7dae34ab.js";import{r as q}from"./request.036145e4.js";import{_ as G,a as U}from"./pay.f5d5d1b4.js";var W=V({name:"UniNoticeBar",emits:["click","getmore","close"],props:{text:{type:String,default:""},moreText:{type:String,default:""},backgroundColor:{type:String,default:"#FFF9EA"},speed:{type:Number,default:100},color:{type:String,default:"#FF9A43"},fontSize:{type:Number,default:14},moreColor:{type:String,default:"#FF9A43"},single:{type:[Boolean,String],default:!1},scrollable:{type:[Boolean,String],default:!1},showIcon:{type:[Boolean,String],default:!1},showGetMore:{type:[Boolean,String],default:!1},showClose:{type:[Boolean,String],default:!1}},data:()=>({textWidth:0,boxWidth:0,wrapWidth:"",webviewHide:!1,elId:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,elIdBox:`Uni_${Math.ceil(1e6*Math.random()).toString(36)}`,show:!0,animationDuration:"none",animationPlayState:"paused",animationDelay:"0s"}),computed:{isShowGetMore(){return!0===this.showGetMore||"true"===this.showGetMore},isShowClose(){return!(!0!==this.showClose&&"true"!==this.showClose||!1!==this.showGetMore&&"false"!==this.showGetMore)}},mounted(){this.$nextTick((()=>{this.initSize()}))},methods:{initSize(){if(this.scrollable){let a=[],t=new Promise(((a,t)=>{e().in(this).select(`#${this.elId}`).boundingClientRect().exec((e=>{this.textWidth=e[0].width,a()}))})),o=new Promise(((a,t)=>{e().in(this).select(`#${this.elIdBox}`).boundingClientRect().exec((e=>{this.boxWidth=e[0].width,a()}))}));a.push(t),a.push(o),Promise.all(a).then((()=>{this.animationDuration=this.textWidth/this.speed+"s",this.animationDelay=`-${this.boxWidth/this.speed}s`,setTimeout((()=>{this.animationPlayState="running"}),1e3)}))}},loopAnimation(){},clickMore(){this.$emit("getmore")},close(){this.show=!1,this.$emit("close")},onClick(){this.$emit("click")}}},[["render",function(e,p,h,f,y,g){const b=I(a("uni-icons"),T),_=d,A=m;return y.show?(t(),o(A,{key:0,class:"uni-noticebar",style:r({backgroundColor:h.backgroundColor}),onClick:g.onClick},{default:l((()=>[!0===h.showIcon||"true"===h.showIcon?(t(),o(b,{key:0,class:"uni-noticebar-icon",type:"sound",color:h.color,size:1.5*h.fontSize},null,8,["color","size"])):n("",!0),i(A,{ref:"textBox",class:s(["uni-noticebar__content-wrapper",{"uni-noticebar__content-wrapper--scrollable":h.scrollable,"uni-noticebar__content-wrapper--single":!h.scrollable&&(h.single||h.moreText)}]),style:r({height:h.scrollable?1.5*h.fontSize+"px":"auto"})},{default:l((()=>[i(A,{id:y.elIdBox,class:s(["uni-noticebar__content",{"uni-noticebar__content--scrollable":h.scrollable,"uni-noticebar__content--single":!h.scrollable&&(h.single||h.moreText)}])},{default:l((()=>[i(_,{id:y.elId,ref:"animationEle",class:s(["uni-noticebar__content-text",{"uni-noticebar__content-text--scrollable":h.scrollable,"uni-noticebar__content-text--single":!h.scrollable&&(h.single||h.showGetMore)}]),style:r({color:h.color,fontSize:h.fontSize+"px",lineHeight:1.5*h.fontSize+"px",width:y.wrapWidth+"px",animationDuration:y.animationDuration,"-webkit-animationDuration":y.animationDuration,animationPlayState:y.webviewHide?"paused":y.animationPlayState,"-webkit-animationPlayState":y.webviewHide?"paused":y.animationPlayState,animationDelay:y.animationDelay,"-webkit-animationDelay":y.animationDelay})},{default:l((()=>[c(u(h.text),1)])),_:1},8,["id","class","style"])])),_:1},8,["id","class"])])),_:1},8,["class","style"]),g.isShowGetMore?(t(),o(A,{key:1,class:"uni-noticebar__more uni-cursor-point",onClick:g.clickMore},{default:l((()=>[h.moreText.length>0?(t(),o(_,{key:0,style:r({color:h.moreColor,fontSize:h.fontSize+"px"})},{default:l((()=>[c(u(h.moreText),1)])),_:1},8,["style"])):(t(),o(b,{key:1,type:"right",color:h.moreColor,size:1.1*h.fontSize},null,8,["color","size"]))])),_:1},8,["onClick"])):n("",!0),g.isShowClose?(t(),o(A,{key:2,class:"uni-noticebar-close uni-cursor-point"},{default:l((()=>[i(b,{type:"closeempty",color:h.color,size:1.1*h.fontSize,onClick:g.close},null,8,["color","size","onClick"])])),_:1})):n("",!0)])),_:1},8,["style","onClick"])):n("",!0)}],["__scopeId","data-v-5f22af90"]]);var Q=V({data:()=>({userInfo:p("user_info"),indicatorDots:!0,autoplay:!0,interval:2e3,duration:500,noticetext:"欢迎来到亲密记",incomecount:0,paycount:0,accountFormData:{money:0,reType:1,keepTime:"",remark:"",planId:"",payType:"",purpose:""},reTypes:[{text:"收入",value:0},{text:"支出",value:1}],planIdRange:[],purposeRange:[],payTypeRange:[],rules:{keepTime:{rules:[{required:!0,errorMessage:"请选择日期"}]},purpose:{rules:[{required:!0,errorMessage:"请选择账单分类"}]},payType:{rules:[{required:!0,errorMessage:"请选择支付方式"}]},money:{rules:[{format:"number",errorMessage:"金额只能输入数字"}]},remark:{rules:[{required:!0,errorMessage:"备注不能为空"}]}}}),onLoad(){this.getNotice(),this.getBillCount(!1)},onReady(){this.getPurpose(),this.getPayType()},methods:{getNotice(){var e=p("notice_index");e>=10?h({url:"/api/ika/v1/sysdic/getnotice",method:"GET",timeout:3e3,success:e=>{console.log(e.data),1===e.data.status?(f("notice_index",1),f("notice_msg",e.data.message),this.noticetext=e.data.message):y({title:"请求通知信息："+e.data.message,icon:"error",duration:2e3})},fail:e=>{y({title:"请求通知信息："+e.errMsg,icon:"fail",duration:2e3})}}):(f("notice_index",e+1),this.noticetext=p("notice_msg"))},selectCount(){g({url:"/pages/index/monthbill/monthbill"})},getPurpose(){const e=p("purpose_data");null!==e&&""!==e||(q.getPurpose(),e=p("purpose_data")),this.purposeRange=e},getPayType(){const e=p("paytype_data");null!==e&&""!==e||(q.getPayType(),e=p("paytype_data")),this.payTypeRange=e},addBill(){E.checkLogin(!1)?this.$refs.popup.open():y({title:"请先登录",icon:"exception",duration:2e3})},submitAccount(e){var a=this;a.$refs[e].validate().then((e=>{h({url:"/api/ika/v1/accountrecord/add",method:"POST",timeout:3e3,header:{Authorization:a.userInfo.token},data:a.accountFormData,success:e=>{1===e.data.status?(y({title:e.data.message,icon:"success",duration:1e3}),a.$refs.popup.close(),a.accountFormData.keepTime.substring(0,7)===j.formatMonth(new Date)&&a.getBillCount(!0)):y({title:e.data.message,icon:"error",duration:2e3})},fail:e=>{y({title:e.errMsg,icon:"fail",duration:2e3})}})})).catch((e=>{y({title:e[0].errorMessage,icon:"fail",duration:2e3})}))},changeDate(e){this.accountFormData.keepTime=e},getPlanData(){var e=this;let a=e.accountFormData.keepTime;""===a&&(a=j.formatDate(new Date)),h({url:"/api/ika/v1/plan/getbydate?date="+a,method:"GET",timeout:3e3,header:{Authorization:e.userInfo.token},success:a=>{1===a.data.status?e.planIdRange=a.data.data:y({title:a.data.message,icon:"error",duration:2e3})},fail:e=>{y({title:e.errMsg,icon:"fail",duration:2e3})}})},changePlanId(e){this.accountFormData.planId=e},getBillCount(e){var a=this;if(!E.checkLogin(!1))return;b({title:"金额统计刷新中……"});let t=100;e&&(t=2e3),q.getMonthBillCount(e),setTimeout((()=>{const e=p("month_income_cache"),t=p("month_paymoney_cache");a.incomecount=e,a.paycount=t,_()}),t)}}},[["render",function(e,s,r,p,h,f){const y=I(a("uni-notice-bar"),W),g=m,b=k,_=w,T=D,V=C,E=d,j=F,q=I(a("uni-easyinput"),M),Q=I(a("uni-forms-item"),P),J=I(a("uni-data-checkbox"),S),H=I(a("uni-datetime-picker"),v),O=I(a("uni-data-select"),z),Y=I(a("uni-forms"),R),N=I(a("uni-popup"),B);return t(),A(x,null,[i(g,null,{default:l((()=>[h.noticetext?(t(),o(y,{key:0,scrollable:"",single:"",text:h.noticetext},null,8,["text"])):n("",!0)])),_:1}),i(g,null,{default:l((()=>[i(V,{class:"swiper",circular:"","indicator-dots":h.indicatorDots,autoplay:h.autoplay,interval:h.interval,duration:h.duration},{default:l((()=>[i(T,null,{default:l((()=>[i(_,{url:"/pages/mime/mime","hover-class":"none"},{default:l((()=>[i(g,{class:"swiper-item"},{default:l((()=>[i(b,{src:"/assets/lunbo1.e2857a6a.png"})])),_:1})])),_:1})])),_:1}),i(T,null,{default:l((()=>[i(_,{url:"/pages/mime/myplan/myplan","hover-class":"none"},{default:l((()=>[i(g,{class:"swiper-item"},{default:l((()=>[i(b,{src:"/assets/lunbo2.7930c787.png"})])),_:1})])),_:1})])),_:1}),i(T,null,{default:l((()=>[i(_,{url:"/pages/mime/mime","hover-class":"none"},{default:l((()=>[i(g,{class:"swiper-item"},{default:l((()=>[i(b,{src:"/assets/lunbo3.28a4fbd5.png"})])),_:1})])),_:1})])),_:1})])),_:1},8,["indicator-dots","autoplay","interval","duration"])])),_:1}),i(g,{class:"container"},{default:l((()=>[i(g,{class:"showcard"},{default:l((()=>[i(g,{class:"cardhead"},{default:l((()=>[i(g,{class:"headblock"},{default:l((()=>[i(b,{class:"cardicon",src:G}),i(E,{class:"cardtext1"},{default:l((()=>[c("本月收入")])),_:1}),i(E,{class:"cardtext2"},{default:l((()=>[c("￥ "+u(h.incomecount),1)])),_:1})])),_:1}),i(g,{class:"headline"}),i(g,{class:"headblock"},{default:l((()=>[i(b,{class:"cardicon",src:U}),i(E,{class:"cardtext3"},{default:l((()=>[c("本月支出")])),_:1}),i(E,{class:"cardtext2"},{default:l((()=>[c("￥ "+u(h.paycount),1)])),_:1})])),_:1})])),_:1}),i(g,{class:"cardline"}),i(g,{class:"cardselect",onClick:f.selectCount},{default:l((()=>[i(E,{class:"counttext"},{default:l((()=>[c("查看当月明细")])),_:1}),i(b,{class:"moreicon",src:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA01JREFUWEfFl02IFFcQx//Vvbte1Ai7IBoNYvyADeQQV9ZlumZ78RJyyC1eRE/qzYRAPJhLFMQcIoJ6MzkleFHwoB48GLa3643J4MdBcWH9ANFEkezCsuaSZbpLnnQPPePObPesk+3TzOt6r35Vr97/VROW+aFl9o+OAAYHB/sGBgbWRlG0loiUiF6IyMtOgskNwMyfAdgN4AsAfgtnl1T1hjHmfF6YRQF8398QRdE3AL4G8JSIrsZxfA3AC1V92dvb+0GtVhshohEAuwCMqOpxY8yxPBBtATzP20dEJwD8o6rni0SWx7m1aQnged4xIvoBwCUR2ZN3waJ2CwKMjo5yHMdhkVQWdZzavwOQ7PkNAJdF5PtOF8477x0AZv4JwJiIDOVdZCl2DQDJUftDVQ93o+BsXTWfjgaApPD2i8jmpUTVai4zqz3OInJuwRpg5j8B3BeRg10CuElEs2EYWjF7+9QzYOW1v7//P1UdM8YEXQI4DeBbEan7rf8ol8sbVfWZqm43xjxMAYaHh1f39fVtEpF7zVC+72+xY0EQPG5+x8yfzs/PP61Wq3PpO8/zviKiiwDWp3dHHaBUKg05jnMrjuPVlUrldTqJmcet9jdrAjMPAniQ2H0iIpMZR6mIBSIylo4nR/y5qg4ZY+40bEFRABt9FEWP7CKu627NZiGjog0ApVJpleM4c3Ec76xUKrcbAFptge/7a2q12scpcTbVSRaQjT6ThR09PT1PgiCYzYxtI6IpIvooDMPn/3sRep7nE9H4zMzMisnJyfkGAPvH7jcR3QnD8LtunIJyuXxKVXdk66JZCY8AOCAi27sBwMxTAH4RESv3jTqQZMB2PV2RYs/zDhGRVcAREbm7IEAC0ZXLiJlt1Y+LiM1y/Wl1HVcAVN9XI8LMVnyGXdctBUHwV1sA+zJpxX59Hw1Jqgmqut8Y81tzbeVpyX7stDFh5pMAjrYLpG1TmrRmPwP4t0hTmhTcIQArHcc5ODExIa1OVdG2/G8Av6vqhbQtfysmROvsBUNEe5Nvhw8BnHVd90zznufegmZD2y2p6pdE9LktqBYRVVX1OhFdyR61dpqyaAYWmpz9NEsuo1fT09OvUnktImIdARRxsJjtsgO8Aa2CqDBXAWwFAAAAAElFTkSuQmCC"})])),_:1},8,["onClick"]),i(g,{class:"cardline"}),i(g,{class:"cardbottom"},{default:l((()=>[i(j,{class:"cardbtn",onClick:f.addBill},{default:l((()=>[c("记一笔")])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1}),i(g,null,{default:l((()=>[i(N,{ref:"popup",type:"left","background-color":"#fff"},{default:l((()=>[i(g,{class:"add-account-form"},{default:l((()=>[i(Y,{ref:"valiForm",rules:h.rules,modelValue:h.accountFormData},{default:l((()=>[i(Q,{label:"金额",required:"",name:"money"},{default:l((()=>[i(q,{modelValue:h.accountFormData.money,"onUpdate:modelValue":s[0]||(s[0]=e=>h.accountFormData.money=e),placeholder:"请输入金额"},null,8,["modelValue"])])),_:1}),i(Q,{label:"收支",required:""},{default:l((()=>[i(J,{mode:"button",modelValue:h.accountFormData.reType,"onUpdate:modelValue":s[1]||(s[1]=e=>h.accountFormData.reType=e),localdata:h.reTypes},null,8,["modelValue","localdata"])])),_:1}),i(Q,{label:"日期",required:"",name:"keepTime"},{default:l((()=>[i(H,{type:"date","clear-icon":!1,modelValue:h.accountFormData.keepTime,"onUpdate:modelValue":s[2]||(s[2]=e=>h.accountFormData.keepTime=e),onChange:f.changeDate},null,8,["modelValue","onChange"])])),_:1}),i(Q,{label:"账单分类",required:"",name:"purpose"},{default:l((()=>[i(O,{localdata:h.purposeRange,modelValue:h.accountFormData.purpose,"onUpdate:modelValue":s[3]||(s[3]=e=>h.accountFormData.purpose=e)},null,8,["localdata","modelValue"])])),_:1}),i(Q,{label:"支付方式",required:"",name:"payType"},{default:l((()=>[i(O,{localdata:h.payTypeRange,modelValue:h.accountFormData.payType,"onUpdate:modelValue":s[4]||(s[4]=e=>h.accountFormData.payType=e)},null,8,["localdata","modelValue"])])),_:1}),i(Q,{label:"计划",name:"planId"},{default:l((()=>[i(O,{modelValue:h.accountFormData.planId,"onUpdate:modelValue":s[5]||(s[5]=e=>h.accountFormData.planId=e),localdata:h.planIdRange,onClick:f.getPlanData,onChange:f.changePlanId},null,8,["modelValue","localdata","onClick","onChange"])])),_:1}),i(Q,{label:"备注",required:"",name:"remark"},{default:l((()=>[i(q,{type:"textarea",modelValue:h.accountFormData.remark,"onUpdate:modelValue":s[6]||(s[6]=e=>h.accountFormData.remark=e),placeholder:"请输入备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","modelValue"]),i(j,{class:"form-btn",type:"primary",onClick:s[7]||(s[7]=e=>f.submitAccount("valiForm"))},{default:l((()=>[c("提交")])),_:1})])),_:1})])),_:1},512)])),_:1})],64)}],["__scopeId","data-v-22261f52"]]);export{Q as default};
