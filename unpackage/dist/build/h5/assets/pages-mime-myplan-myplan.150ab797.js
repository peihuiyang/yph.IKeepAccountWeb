import{o as e,a,w as t,f as n,t as i,n as r,e as l,b as o,i as u,C as s,r as c,d as p,m as d,T as g,F as m,v as h,a1 as f,g as x,h as y,l as _,H as k,j as b,J as v,k as I}from"./index.eda1eb19.js";import{_ as P}from"./uni-segmented-control.3611dfc2.js";import{_ as T,r as S}from"./uni-app.es.a5116263.js";import{_ as C}from"./uni-card.bd3c14c4.js";import{_ as z}from"./uni-icons.67cc16ba.js";import{_ as D}from"./uni-fab.487798f8.js";import{_ as F}from"./uni-easyinput.bcf294d4.js";import{_ as V,a as w,b as M,c as j,d as N}from"./uni-forms.96536d14.js";import{_ as R}from"./uni-popup.ce1781dd.js";import{m as U}from"./mylogin.7e14d1f7.js";var A=T({name:"UniTag",emits:["click"],props:{type:{type:String,default:"default"},size:{type:String,default:"normal"},text:{type:String,default:""},disabled:{type:[Boolean,String],default:!1},inverted:{type:[Boolean,String],default:!1},circle:{type:[Boolean,String],default:!1},mark:{type:[Boolean,String],default:!1},customStyle:{type:String,default:""}},computed:{classes(){const{type:e,disabled:a,inverted:t,circle:n,mark:i,size:r,isTrue:l}=this;return["uni-tag--"+e,"uni-tag--"+r,l(a)?"uni-tag--disabled":"",l(t)?"uni-tag--"+e+"--inverted":"",l(n)?"uni-tag--circle":"",l(i)?"uni-tag--mark":"",l(t)?"uni-tag--inverted uni-tag-text--"+e:"","small"===r?"uni-tag-text--small":""].join(" ")}},methods:{isTrue:e=>!0===e||"true"===e,onClick(){this.isTrue(this.disabled)||this.$emit("click")}}},[["render",function(s,c,p,d,g,m){const h=u;return p.text?(e(),a(h,{key:0,class:r(["uni-tag",m.classes]),style:l(p.customStyle),onClick:m.onClick},{default:t((()=>[n(i(p.text),1)])),_:1},8,["class","style","onClick"])):o("",!0)}],["__scopeId","data-v-7a888830"]]),$={en:{"uni-pagination.prevText":"prev","uni-pagination.nextText":"next","uni-pagination.piecePerPage":"piece/page"},es:{"uni-pagination.prevText":"anterior","uni-pagination.nextText":"prxima","uni-pagination.piecePerPage":"Art��culo/P��gina"},fr:{"uni-pagination.prevText":"précédente","uni-pagination.nextText":"suivante","uni-pagination.piecePerPage":"Articles/Pages"},"zh-Hans":{"uni-pagination.prevText":"上一页","uni-pagination.nextText":"下一页","uni-pagination.piecePerPage":"条/页"},"zh-Hant":{"uni-pagination.prevText":"上一頁","uni-pagination.nextText":"下一頁","uni-pagination.piecePerPage":"條/頁"}};const{t:q}=s($);var L=T({name:"UniPagination",emits:["update:modelValue","input","change","pageSizeChange"],props:{value:{type:[Number,String],default:1},modelValue:{type:[Number,String],default:1},prevText:{type:String},nextText:{type:String},piecePerPageText:{type:String},current:{type:[Number,String],default:1},total:{type:[Number,String],default:0},pageSize:{type:[Number,String],default:10},showIcon:{type:[Boolean,String],default:!1},showPageSize:{type:[Boolean,String],default:!1},pagerCount:{type:Number,default:7},pageSizeRange:{type:Array,default:()=>[20,50,100,500]}},data:()=>({pageSizeIndex:0,currentIndex:1,paperData:[],pickerShow:!1}),computed:{piecePerPage(){return this.piecePerPageText||q("uni-pagination.piecePerPage")},prevPageText(){return this.prevText||q("uni-pagination.prevText")},nextPageText(){return this.nextText||q("uni-pagination.nextText")},maxPage(){let e=1,a=Number(this.total),t=Number(this.pageSize);return a&&t&&(e=Math.ceil(a/t)),e},paper(){const e=this.currentIndex,a=this.pagerCount,t=this.total,n=this.pageSize;let i=[],r=[],l=Math.ceil(t/n);for(let u=0;u<l;u++)i.push(u+1);r.push(1);const o=i[i.length-(a+1)/2];return i.forEach(((t,n)=>{(a+1)/2>=e?t<a+1&&t>1&&r.push(t):e+2<=o?t>e-(a+1)/2&&t<e+(a+1)/2&&r.push(t):(t>e-(a+1)/2||l-a<t)&&t<i[i.length-1]&&r.push(t)})),l>a?((a+1)/2>=e?r[r.length-1]="...":e+2<=o?(r[1]="...",r[r.length-1]="..."):r[1]="...",r.push(i[i.length-1])):(a+1)/2>=e||e+2<=o||(r.shift(),r.push(i[i.length-1])),r}},watch:{current:{immediate:!0,handler(e,a){this.currentIndex=e<1?1:e}},value:{immediate:!0,handler(e){1===Number(this.current)&&(this.currentIndex=e<1?1:e)}},pageSizeIndex(e){this.$emit("pageSizeChange",this.pageSizeRange[e])}},methods:{pickerChange(e){this.pageSizeIndex=e.detail.value,this.pickerClick()},pickerClick(){const e=document.querySelector("body");if(!e)return;const a="uni-pagination-picker-show";this.pickerShow=!this.pickerShow,this.pickerShow?e.classList.add(a):setTimeout((()=>e.classList.remove(a)),300)},selectPage(e,a){if(parseInt(e))this.currentIndex=e,this.change("current");else{let e=Math.ceil(this.total/this.pageSize);if(a<=1)return void(this.currentIndex-5>1?this.currentIndex-=5:this.currentIndex=1);if(a>=6)return void(this.currentIndex+5>e?this.currentIndex=e:this.currentIndex+=5)}},clickLeft(){1!==Number(this.currentIndex)&&(this.currentIndex-=1,this.change("prev"))},clickRight(){Number(this.currentIndex)>=this.maxPage||(this.currentIndex+=1,this.change("next"))},change(e){this.$emit("input",this.currentIndex),this.$emit("update:modelValue",this.currentIndex),this.$emit("change",{type:e,current:this.currentIndex})}}},[["render",function(l,s,y,_,k,b){const v=u,I=S(c("uni-icons"),z),P=h,T=f,C=x;return e(),a(C,{class:"uni-pagination"},{default:t((()=>[!0===y.showPageSize||"true"===y.showPageSize?(e(),a(T,{key:0,class:"select-picker",mode:"selector",value:k.pageSizeIndex,range:y.pageSizeRange,onChange:b.pickerChange,onCancel:b.pickerClick,onClick:b.pickerClick},{default:t((()=>[p(P,{type:"default",size:"mini",plain:!0},{default:t((()=>[p(v,null,{default:t((()=>[n(i(y.pageSizeRange[k.pageSizeIndex])+" "+i(b.piecePerPage),1)])),_:1}),p(I,{class:"select-picker-icon",type:"arrowdown",size:"12",color:"#999"})])),_:1})])),_:1},8,["value","range","onChange","onCancel","onClick"])):o("",!0),p(C,{class:"uni-pagination__total is-phone-hide"},{default:t((()=>[n("共 "+i(y.total)+" 条",1)])),_:1}),p(C,{class:r(["uni-pagination__btn",1===k.currentIndex?"uni-pagination--disabled":"uni-pagination--enabled"]),"hover-class":1===k.currentIndex?"":"uni-pagination--hover","hover-start-time":20,"hover-stay-time":70,onClick:b.clickLeft},{default:t((()=>[!0===y.showIcon||"true"===y.showIcon?(e(),a(I,{key:0,color:"#666",size:"16",type:"left"})):(e(),a(v,{key:1,class:"uni-pagination__child-btn"},{default:t((()=>[n(i(b.prevPageText),1)])),_:1}))])),_:1},8,["class","hover-class","onClick"]),p(C,{class:"uni-pagination__num uni-pagination__num-flex-none"},{default:t((()=>[p(C,{class:"uni-pagination__num-current"},{default:t((()=>[p(v,{class:"uni-pagination__num-current-text is-pc-hide current-index-text"},{default:t((()=>[n(i(k.currentIndex),1)])),_:1}),p(v,{class:"uni-pagination__num-current-text is-pc-hide"},{default:t((()=>[n("/"+i(b.maxPage||0),1)])),_:1}),(e(!0),d(m,null,g(b.paper,((l,o)=>(e(),a(C,{key:o,class:r([{"page--active":l===k.currentIndex},"uni-pagination__num-tag tag--active is-phone-hide"]),onClick:e=>b.selectPage(l,o)},{default:t((()=>[p(v,null,{default:t((()=>[n(i(l),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),p(C,{class:r(["uni-pagination__btn",k.currentIndex>=b.maxPage?"uni-pagination--disabled":"uni-pagination--enabled"]),"hover-class":k.currentIndex===b.maxPage?"":"uni-pagination--hover","hover-start-time":20,"hover-stay-time":70,onClick:b.clickRight},{default:t((()=>[!0===y.showIcon||"true"===y.showIcon?(e(),a(I,{key:0,color:"#666",size:"16",type:"right"})):(e(),a(v,{key:1,class:"uni-pagination__child-btn"},{default:t((()=>[n(i(b.nextPageText),1)])),_:1}))])),_:1},8,["class","hover-class","onClick"])])),_:1})}],["__scopeId","data-v-4bd342e9"]]);var B=T({data:()=>({userInfo:y("user_info"),items:["月计划","周计划","年计划"],current:0,plans:[],pageIndex:1,numTotal:5,pageSize:5,horizontal:"right",vertical:"bottom",pattern:{color:"#7A7E83",backgroundColor:"#fff",selectedColor:"#007AFF",buttonColor:"#007aFF",iconColor:"#fff"},plandaterange:[Date.now(),Date.now()+5e8],planTypes:[{text:"月计划",value:0},{text:"周计划",value:1},{text:"年计划",value:2}],reTypes:[{text:"收入",value:0},{text:"支出",value:1}],parentIdRange:[],planFormData:{name:"",amountMoney:"",remark:"",planType:0,reType:0,startTime:"",endTime:"",parentId:""},rules:{name:{rules:[{required:!0,errorMessage:"计划不能为空"}]},amountMoney:{rules:[{format:"number",errorMessage:"金额只能输入数字"}]}}}),onLoad(){U.checkLogin(!0),this.getPlanPage(1)},methods:{fabClick(){this.$refs.popup.open(),this.planFormData.startTime=this.plandaterange[0],this.planFormData.endTime=this.plandaterange[1]},onClickItem(e){this.current!==e.currentIndex&&(this.current=e.currentIndex,this.getPlanPage(1))},changePage(e){this.getPlanPage(e.current)},getPlanDetail(e){_({url:"plandetail/plandetail?id="+e})},getPlanPage(e){var a=this;k({title:"数据查询中……"}),a.plans=[],b({url:"/api/ika/v1/plan/findbypage",method:"POST",timeout:3e3,header:{Authorization:a.userInfo.token},data:{uId:a.userInfo.id,pageIndex:e,pageSize:5,planType:a.current},success:e=>{if(v(),1===e.data.status){a.numTotal=e.data.data.totalNum;for(var t=e.data.data.planList,n=0;n<t.length;n++)a.plans.push(t[n])}else I({title:e.data.message,icon:"error",duration:2e3})},fail:e=>{v(),I({title:e.errMsg,icon:"fail",duration:2e3})}})},submitPlan(e){var a=this;a.$refs[e].validate().then((e=>{b({url:"/api/ika/v1/plan/add",method:"POST",timeout:3e3,header:{Authorization:a.userInfo.token},data:a.planFormData,success:e=>{console.log(e.data),1===e.data.status?(I({title:e.data.message,icon:"success",duration:1e3}),a.$refs.popup.close(),a.getPlanPage(1)):I({title:e.data.message,icon:"error",duration:2e3})},fail:e=>{I({title:e.errMsg,icon:"fail",duration:2e3})}})})).catch((e=>{I({title:e[0].errorMessage,icon:"fail",duration:2e3}),console.log("err",e)}))},selectPlanDate(e){this.planFormData.startTime=e[0],this.planFormData.endTime=e[1]},getParentData(){var e=this;b({url:"/api/ika/v1/plan/getnotfinish",method:"GET",timeout:3e3,header:{Authorization:e.userInfo.token},success:a=>{console.log(a.data),1===a.data.status?e.parentIdRange=a.data.data:I({title:a.data.message,icon:"error",duration:2e3})},fail:e=>{I({title:e.errMsg,icon:"fail",duration:2e3})}})},changeParentId(e){this.planFormData.parentId=e}}},[["render",function(r,l,s,f,y,_){const k=S(c("uni-segmented-control"),P),b=x,v=S(c("uni-tag"),A),I=u,T=S(c("uni-card"),C),z=S(c("uni-pagination"),L),U=S(c("uni-fab"),D),$=S(c("uni-easyinput"),F),q=S(c("uni-forms-item"),V),B=S(c("uni-data-checkbox"),w),E=S(c("uni-datetime-picker"),M),H=S(c("uni-data-select"),j),O=S(c("uni-forms"),N),G=h,J=S(c("uni-popup"),R);return e(),d(m,null,[p(b,{class:"uni-padding-wrap uni-common-mt"},{default:t((()=>[p(k,{current:y.current,values:y.items,onClickItem:_.onClickItem},null,8,["current","values","onClickItem"])])),_:1}),p(b,{class:"content"},{default:t((()=>[0===y.current?(e(),a(b,{key:0,class:"card_list"},{default:t((()=>[(e(!0),d(m,null,g(y.plans,(r=>(e(),a(b,null,{default:t((()=>[p(T,{title:r.name,"sub-title":r.code,extra:r.reType_Desc,onClick:e=>_.getPlanDetail(r.id)},{default:t((()=>[p(v,{mark:!0,text:r.amountMoney,type:0===r.reType?"primary":"error",size:"mini"},null,8,["text","type"]),p(I,{class:"uni-card-body"},{default:t((()=>[n(" 备注: "+i(r.remark),1)])),_:2},1024)])),_:2},1032,["title","sub-title","extra","onClick"])])),_:2},1024)))),256)),p(z,{class:"cust_pagination","show-icon":!0,title:"分页",total:y.numTotal,current:y.pageIndex,pageSize:y.pageSize,onChange:_.changePage},null,8,["total","current","pageSize","onChange"])])),_:1})):o("",!0),1===y.current?(e(),a(b,{key:1,class:"card_list"},{default:t((()=>[(e(!0),d(m,null,g(y.plans,(r=>(e(),a(b,null,{default:t((()=>[p(T,{title:r.name,"sub-title":r.code,extra:r.reType_Desc},{default:t((()=>[p(v,{mark:!0,text:r.amountMoney,type:0===r.reType?"primary":"error",size:"mini"},null,8,["text","type"]),p(I,{class:"uni-card-body"},{default:t((()=>[n(" 备注: "+i(r.remark),1)])),_:2},1024)])),_:2},1032,["title","sub-title","extra"])])),_:2},1024)))),256)),p(z,{class:"cust_pagination","show-icon":!0,title:"分页",total:y.numTotal,current:y.pageIndex,pageSize:y.pageSize,onChange:_.changePage},null,8,["total","current","pageSize","onChange"])])),_:1})):o("",!0),2===y.current?(e(),a(b,{key:2,class:"card_list"},{default:t((()=>[(e(!0),d(m,null,g(y.plans,(r=>(e(),a(b,null,{default:t((()=>[p(T,{title:r.name,"sub-title":r.code,extra:r.reType_Desc},{default:t((()=>[p(v,{mark:!0,text:r.amountMoney,type:0===r.reType?"primary":"error",size:"mini"},null,8,["text","type"]),p(I,{class:"uni-card-body"},{default:t((()=>[n(" 备注: "+i(r.remark),1)])),_:2},1024)])),_:2},1032,["title","sub-title","extra"])])),_:2},1024)))),256)),p(z,{class:"cust_pagination","show-icon":!0,title:"分页",total:y.numTotal,current:y.pageIndex,pageSize:y.pageSize,onChange:_.changePage},null,8,["total","current","pageSize","onChange"])])),_:1})):o("",!0)])),_:1}),p(U,{class:"myfab",ref:"fab",pattern:y.pattern,horizontal:y.horizontal,vertical:y.vertical,onFabClick:_.fabClick},null,8,["pattern","horizontal","vertical","onFabClick"]),p(b,null,{default:t((()=>[p(J,{ref:"popup",type:"bottom","background-color":"#fff"},{default:t((()=>[p(b,{class:"add-plan-form"},{default:t((()=>[p(O,{ref:"valiForm",rules:y.rules,modelValue:y.planFormData},{default:t((()=>[p(q,{label:"计划名",required:"",name:"name"},{default:t((()=>[p($,{modelValue:y.planFormData.name,"onUpdate:modelValue":l[0]||(l[0]=e=>y.planFormData.name=e),placeholder:"请输入计划名"},null,8,["modelValue"])])),_:1}),p(q,{label:"收支",required:""},{default:t((()=>[p(B,{mode:"button",modelValue:y.planFormData.reType,"onUpdate:modelValue":l[1]||(l[1]=e=>y.planFormData.reType=e),localdata:y.reTypes},null,8,["modelValue","localdata"])])),_:1}),p(q,{label:"计划类型",required:""},{default:t((()=>[p(B,{mode:"button",modelValue:y.planFormData.planType,"onUpdate:modelValue":l[2]||(l[2]=e=>y.planFormData.planType=e),localdata:y.planTypes},null,8,["modelValue","localdata"])])),_:1}),p(q,{label:"金额",required:"",name:"amountMoney"},{default:t((()=>[p($,{modelValue:y.planFormData.amountMoney,"onUpdate:modelValue":l[3]||(l[3]=e=>y.planFormData.amountMoney=e),placeholder:"请输入金额"},null,8,["modelValue"])])),_:1}),p(q,{label:"日期",required:"",name:"dateform"},{default:t((()=>[p(E,{modelValue:y.plandaterange,"onUpdate:modelValue":l[4]||(l[4]=e=>y.plandaterange=e),type:"daterange",onChange:_.selectPlanDate},null,8,["modelValue","onChange"])])),_:1}),p(q,{label:"父级",name:"parentId"},{default:t((()=>[p(H,{modelValue:y.planFormData.parentId,"onUpdate:modelValue":l[5]||(l[5]=e=>y.planFormData.parentId=e),localdata:y.parentIdRange,onClick:_.getParentData,onChange:_.changeParentId},null,8,["modelValue","localdata","onClick","onChange"])])),_:1}),p(q,{label:"备注",name:"remark"},{default:t((()=>[p($,{type:"textarea",modelValue:y.planFormData.remark,"onUpdate:modelValue":l[6]||(l[6]=e=>y.planFormData.remark=e),placeholder:"请输入备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["rules","modelValue"]),p(G,{class:"form-btn",type:"primary",onClick:l[7]||(l[7]=e=>_.submitPlan("valiForm"))},{default:t((()=>[n("提交")])),_:1})])),_:1})])),_:1},512)])),_:1})],64)}],["__scopeId","data-v-54fd6818"]]);export{B as default};
